<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hooks 介绍 | shyarcher </title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/icon.jpg">
    <meta name="description" content="程序员的浪漫就是，当你放下手头的工作时，窗外夕阳正好，落叶满地，银色满际">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.1b02cb7d.js" as="script"><link rel="preload" href="/assets/js/2.9788d3fd.js" as="script"><link rel="preload" href="/assets/js/16.89b6987f.js" as="script"><link rel="prefetch" href="/assets/js/10.d36ab27c.js"><link rel="prefetch" href="/assets/js/11.5659a136.js"><link rel="prefetch" href="/assets/js/12.6d7245f0.js"><link rel="prefetch" href="/assets/js/13.d9485d1c.js"><link rel="prefetch" href="/assets/js/14.542a0ec3.js"><link rel="prefetch" href="/assets/js/15.e569712e.js"><link rel="prefetch" href="/assets/js/17.6eb0b6cf.js"><link rel="prefetch" href="/assets/js/18.ebb68d18.js"><link rel="prefetch" href="/assets/js/19.428ed358.js"><link rel="prefetch" href="/assets/js/20.4074b548.js"><link rel="prefetch" href="/assets/js/21.dfeac051.js"><link rel="prefetch" href="/assets/js/22.1a25f739.js"><link rel="prefetch" href="/assets/js/23.38a193b0.js"><link rel="prefetch" href="/assets/js/24.46fe3449.js"><link rel="prefetch" href="/assets/js/25.7759881a.js"><link rel="prefetch" href="/assets/js/26.8e05727c.js"><link rel="prefetch" href="/assets/js/27.5cbb0a47.js"><link rel="prefetch" href="/assets/js/28.f4554195.js"><link rel="prefetch" href="/assets/js/29.408e403e.js"><link rel="prefetch" href="/assets/js/3.7651c91f.js"><link rel="prefetch" href="/assets/js/30.410c0b65.js"><link rel="prefetch" href="/assets/js/31.ea942dbd.js"><link rel="prefetch" href="/assets/js/32.b785b30b.js"><link rel="prefetch" href="/assets/js/33.f6a5adef.js"><link rel="prefetch" href="/assets/js/34.4cd64d4f.js"><link rel="prefetch" href="/assets/js/35.8d895c60.js"><link rel="prefetch" href="/assets/js/4.2b93dc1f.js"><link rel="prefetch" href="/assets/js/5.f064699d.js"><link rel="prefetch" href="/assets/js/6.258c7694.js"><link rel="prefetch" href="/assets/js/7.73b19b4c.js"><link rel="prefetch" href="/assets/js/8.e81bf8c4.js"><link rel="prefetch" href="/assets/js/9.7f372900.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icon.jpg" alt="shyarcher " class="logo"> <span class="site-name can-hide">shyarcher </span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/notes/01vue的基本概念.html" class="nav-link">
  vue相关
</a></li><li class="dropdown-item"><!----> <a href="/pages/notes/git笔记.html" class="nav-link">
  其他学习笔记
</a></li><li class="dropdown-item"><!----> <a href="/pages/notes/nodejs后台起服务步骤.html" class="nav-link">
  打包工具&amp;模块搭建
</a></li><li class="dropdown-item"><!----> <a href="/pages/notes/Windows触摸板操作及谷歌浏览器快捷键整理.html" class="nav-link">
  旧版迁移内容
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/ShyArcher" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title">分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="分类" class="mobile-dropdown-title"><span class="title">分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/notes/01vue的基本概念.html" class="nav-link">
  vue相关
</a></li><li class="dropdown-item"><!----> <a href="/pages/notes/git笔记.html" class="nav-link">
  其他学习笔记
</a></li><li class="dropdown-item"><!----> <a href="/pages/notes/nodejs后台起服务步骤.html" class="nav-link">
  打包工具&amp;模块搭建
</a></li><li class="dropdown-item"><!----> <a href="/pages/notes/Windows触摸板操作及谷歌浏览器快捷键整理.html" class="nav-link">
  旧版迁移内容
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/ShyArcher" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/notes/01vue的基本概念.html" class="sidebar-link">01vue的基本概念</a></li><li><a href="/pages/notes/02侦听器和axios.html" class="sidebar-link">02侦听器和axios</a></li><li><a href="/pages/notes/03vue生命周期和组件数据传递.html" class="sidebar-link">03vue生命周期和组件数据传递</a></li><li><a href="/pages/notes/04vuex笔记.html" class="sidebar-link">04vuex笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/notes/原型和继承.html" class="sidebar-link">原型和继承</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>React相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/notes/React学习笔记.html" class="sidebar-link">React学习笔记</a></li><li><a href="/pages/notes/Hooks笔记.html" class="active sidebar-link">Hooks笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他学习笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/notes/git笔记.html" class="sidebar-link">git笔记</a></li><li><a href="/pages/notes/jQuery笔记.html" class="sidebar-link">jQuery笔记</a></li><li><a href="/pages/notes/node.js笔记.html" class="sidebar-link">node.js笔记</a></li><li><a href="/pages/notes/关于服务器的一些概念.html" class="sidebar-link">关于服务器的一些概念</a></li><li><a href="/pages/notes/echarts笔记.html" class="sidebar-link">echarts笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>打包工具&amp;模块搭建</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/notes/nodejs后台起服务步骤.html" class="sidebar-link">nodejs后台起服务步骤</a></li><li><a href="/pages/notes/webpack笔记.html" class="sidebar-link">webpack笔记</a></li><li><a href="/pages/notes/yapi部署笔记.html" class="sidebar-link">yapi部署笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>旧版迁移内容</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/notes/Windows触摸板操作及谷歌浏览器快捷键整理.html" class="sidebar-link">Windows触摸板操作及谷歌浏览器快捷键整理</a></li><li><a href="/pages/notes/利用Hugo+gitHub搭建个人博客.html" class="sidebar-link">利用Hugo+gitHub搭建个人博客</a></li><li><a href="/pages/notes/利用JavaSwing开发一款桌面塔防游戏.html" class="sidebar-link">利用JavaSwing开发一款桌面塔防游戏</a></li><li><a href="/pages/notes/配置达梦驱动包至本地Maven库.html" class="sidebar-link">配置达梦驱动包至本地Maven库</a></li><li><a href="/pages/notes/热部署插件JRebel使用说明.html" class="sidebar-link">热部署插件JRebel使用说明</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hooks-介绍"><a href="#hooks-介绍" class="header-anchor">#</a> Hooks 介绍</h1> <p></p><div class="table-of-contents"><ul><li><a href="#_1-hooks-是什么">1. Hooks 是什么 ?</a></li><li><a href="#_2-为什么要学习-hooks">2. 为什么要学习 Hooks ?</a></li><li><a href="#_3-学习建议">3. 学习建议</a></li><li><a href="#_1-说明">1. 说明</a></li><li><a href="#_2-语法">2. 语法</a><ul><li><a href="#_2-1-语法格式">2.1 语法格式</a></li><li><a href="#_2-2-语法说明">2.2 语法说明</a></li></ul></li><li><a href="#_3-使用">3. 使用</a><ul><li><a href="#_3-1-声明-state-变量">3.1 声明 State 变量</a></li><li><a href="#_3-2-读取-state">3.2 读取 State</a></li><li><a href="#_3-3-更新-state">3.3 更新 State</a></li><li><a href="#_3-4-总结">3.4 总结</a></li></ul></li><li><a href="#_4-demo">4. Demo</a></li><li><a href="#_1-说明">1. 说明</a></li><li><a href="#_2-语法">2. 语法</a><ul><li><a href="#_2-1-语法格式">2.1 语法格式</a></li><li><a href="#_2-2-语法说明">2.2 语法说明</a></li></ul></li><li><a href="#_3-使用">3. 使用</a><ul><li><a href="#_3-1-基本使用">3.1 基本使用</a></li><li><a href="#_3-1-修改标题案例">3.1 修改标题案例</a></li><li><a href="#_3-2-根据依赖项执行-useeffect">3.2 根据依赖项执行 useEffect</a></li><li><a href="#_3-3-定时器">3.3  定时器</a></li><li><a href="#_3-3-发送请求">3.3  发送请求</a></li><li><a href="#_3-5-清除定时器">3.5 清除定时器</a></li><li><a href="#_3-5-总结">3.5 总结</a></li></ul></li><li><a href="#_1-说明">1. 说明</a></li><li><a href="#_2-语法">2. 语法</a><ul><li><a href="#_2-1-语法格式">2.1 语法格式</a></li><li><a href="#_2-2-语法说明">2.2 语法说明</a></li></ul></li><li><a href="#_3-使用">3. 使用</a><ul><li><a href="#_3-1-用途1-保持可变变量">3.1 用途1- 保持可变变量</a></li><li><a href="#_3-2-用途2-绑定dom节点">3.2 用途2- 绑定DOM节点</a></li><li><a href="#_3-3-useref-用在定时器上">3.3 useRef 用在定时器上</a></li></ul></li><li><a href="#_4-demo-动画案例">4. Demo - 动画案例</a></li><li><a href="#_1-说明">1. 说明</a></li><li><a href="#_2-语法">2. 语法</a><ul><li><a href="#_2-2-语法说明">2.2 语法说明</a></li></ul></li><li><a href="#_3-使用">3. 使用</a><ul><li><a href="#_3-1-重写-usestate-计算器示例">3.1 重写 useState (计算器示例)</a></li><li><a href="#_3-2-usereducer-使用场景">3.2 useReducer 使用场景</a></li></ul></li><li><a href="#_1-说明">1. 说明</a></li><li><a href="#_2-语法">2. 语法</a><ul><li><a href="#_2-1-语法格式">2.1 语法格式</a></li><li><a href="#_2-2-语法说明">2.2 语法说明</a></li><li><a href="#_2-3-使用说明">2.3 使用说明</a></li></ul></li><li><a href="#_3-使用">3. 使用</a><ul><li><a href="#_3-2-功能2-封装-provider-共享数据">3.2 功能2-封装  Provider-共享数据</a></li><li><a href="#_3-3-功能3-usecontext-和-usereducer-组合-redux">3.3 功能3- useContext 和 useReducer 组合 redux</a></li></ul></li><li><a href="#_1-说明">1. 说明</a></li><li><a href="#_2-语法">2. 语法</a><ul><li><a href="#_2-2-语法说明">2.2 语法说明</a></li></ul></li><li><a href="#_2-使用">2. 使用</a></li><li><a href="#_1-说明">1. 说明</a></li><li><a href="#_2-语法">2. 语法</a><ul><li><a href="#_2-2-语法说明">2.2 语法说明</a></li></ul></li><li><a href="#_3-使用">3. 使用</a></li><li><a href="#_4-验证">4. 验证</a></li><li><a href="#_5-使用场景">5. 使用场景</a></li><li><a href="#_1-自定义hook1-usemouse">1. 自定义Hook1 - useMouse</a></li><li><a href="#_2-自定义-hook2-userequest">2. 自定义 Hook2 - useRequest</a></li><li><a href="#_1-准备工作">1. 准备工作</a></li><li><a href="#_2-使用步骤">2. 使用步骤</a><ul><li><a href="#_2-1-界面搭建">2.1 界面搭建</a></li><li><a href="#_2-2-发送请求-home-hot">2.2 发送请求-Home-Hot</a></li><li><a href="#_2-3-封装-provider">2.3 封装 Provider</a></li><li><a href="#_2-4-读取-徽标">2.4 读取 徽标</a></li><li><a href="#_2-5-设置页面-setting">2.5 设置页面 - Setting</a></li></ul></li></ul></div><p></p> <h2 id="_1-hooks-是什么"><a href="#_1-hooks-是什么" class="header-anchor">#</a> 1. Hooks 是什么 ?</h2> <ul><li>Hooks 是 React 16.8 新增的特性，它可以让你在不编写 class(类组件) 的情况下使用 state 以及其他的 React 特性</li> <li>React 一直都提倡使用<strong>函数组件</strong>的，但是函数组件没有实例不能操作state，也没有生命周期函数，只有类组件才有.</li> <li>如果有一天你在编写函数组件中, 突然意识到需要向其添加一些 state， 怎么办呢?  以前的做法是必须将其它转化为 类组件, 现在呢? Hooks出现之后, 你可以在现有的函数组件中配合 Hooks 直接来操作state了</li> <li>从功能上来看  :   <strong>类组件 ≈ 函数组件 + Hooks</strong></li> <li>在 React API中,  凡是 use 开头的  都是 Hooks
<ul><li>比如 : useState、useEffect、useCallback、useContext等等</li></ul></li></ul> <h2 id="_2-为什么要学习-hooks"><a href="#_2-为什么要学习-hooks" class="header-anchor">#</a> 2. 为什么要学习 Hooks ?</h2> <ul><li><p><strong>之前 存在的问题</strong></p> <ul><li>类组件 : 生命周期难以理解，更难熟练运用</li> <li>复用状态的<code>render-props</code>和高阶组件思想理解起来不容易</li> <li>最火的状态管理解决方案 Redux，概念多， 难以理解</li></ul></li> <li><p><strong>学习hooks后 :</strong></p> <ul><li>生命周期可以不用学。react hooks使用全新的理念来管理组件的运作过程。 (useEffect)</li> <li>高阶组件不用学。React hooks能够完美解决高阶组件想要解决的问题，并且更靠谱。 (自定义hook)</li> <li>redux不再是必须品。我们能够通过其他方式管理组件状态。 (useReducer + useContext)</li></ul></li></ul> <h2 id="_3-学习建议"><a href="#_3-学习建议" class="header-anchor">#</a> 3. 学习建议</h2> <ul><li><p>Hooks 和现有代码可以同时工作，你可以渐进式地使用他们。</p></li> <li><p>不用急着迁移到 Hooks。因为 Hooks 是在函数组件中使用的, 如果全部迁移就要重构类组件为函数组件了, 工程过大</p></li></ul> <h1 id="usestate"><a href="#usestate" class="header-anchor">#</a> useState</h1> <h2 id="_1-说明"><a href="#_1-说明" class="header-anchor">#</a> 1. 说明</h2> <ul><li><code>useState</code> 是允许你在 React 函数组件中添加 state 的 Hook (钩子)。</li></ul> <h2 id="_2-语法"><a href="#_2-语法" class="header-anchor">#</a> 2. 语法</h2> <h3 id="_2-1-语法格式"><a href="#_2-1-语法格式" class="header-anchor">#</a> 2.1 语法格式</h3> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialValue<span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-2-语法说明"><a href="#_2-2-语法说明" class="header-anchor">#</a> 2.2 语法说明</h3> <ul><li>参数  :   state变量的初始值</li> <li>返回值 :  数组, 并且通过解构数组获取仅有的两个元素
<ul><li>第一个元素 : state 就是一个状态变量</li> <li>第二个元素 :  <code>setState</code> 是一个用于修改状态的 函数</li></ul></li></ul> <h2 id="_3-使用"><a href="#_3-使用" class="header-anchor">#</a> 3. 使用</h2> <h3 id="_3-1-声明-state-变量"><a href="#_3-1-声明-state-变量" class="header-anchor">#</a> 3.1 声明 State 变量</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token comment">// 声明一个叫 “count” 的 state 变量</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-2-读取-state"><a href="#_3-2-读取-state" class="header-anchor">#</a> 3.2 读取 State</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> <span class="token punctuation">{</span>  count  <span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre></div><h3 id="_3-3-更新-state"><a href="#_3-3-更新-state" class="header-anchor">#</a> 3.3 更新 State</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span> count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">&gt;</span> 累加 count <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setNum</span><span class="token punctuation">(</span> num <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">&gt;</span> 累加 num <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</code></pre></div><h3 id="_3-4-总结"><a href="#_3-4-总结" class="header-anchor">#</a> 3.4 总结</h3> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token number">1</span><span class="token operator">:</span>  <span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
 <span class="token number">2</span><span class="token operator">:</span>
 <span class="token number">3</span><span class="token operator">:</span>  <span class="token keyword">function</span> <span class="token function">Counter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token number">4</span><span class="token operator">:</span>    <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token number">5</span><span class="token operator">:</span>
 <span class="token number">6</span><span class="token operator">:</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>
 <span class="token number">7</span><span class="token operator">:</span>      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
 <span class="token number">8</span><span class="token operator">:</span>        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>  <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
 <span class="token number">9</span><span class="token operator">:</span>        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span> count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token operator">+</span><span class="token number">1</span> <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token number">10</span><span class="token operator">:</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token number">11</span><span class="token operator">:</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">12</span><span class="token operator">:</span>  <span class="token punctuation">}</span>

# 第<span class="token number">1</span>行<span class="token operator">:</span> 引入 React 中的 useState 。
# 第<span class="token number">4</span>行<span class="token operator">:</span> 在 Counter 组件内部，我们通过调用 useState 声明了一个新的 state 变量。它返回一对值给到我们命名的变量上。我们把变量命名为 count，因为它存储的是点击次数。我们通过传 <span class="token number">0</span> 作为 useState 唯一的参数来将其初始化为 <span class="token number">0</span>。第二个返回的值本身就是一个函数。它让我们可以更新 count 的值，所以我们叫它setCount。
# 第<span class="token number">9</span>行<span class="token operator">:</span> 当用户点击按钮后，我们传递一个新的值给 setCount。React 会重新渲染 Counter 组件，并把最新的 count 传给它。
</code></pre></div><h2 id="_4-demo"><a href="#_4-demo" class="header-anchor">#</a> 4. Demo</h2> <ul><li><p>步骤</p> <ol><li>搭建结构 和 样式</li> <li>设置行内样式 方便js操作数据</li> <li>使用 Slider 修改数据</li></ol></li> <li><p>结构</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code># Rectangle<span class="token punctuation">.</span>js 
<span class="token keyword">const</span> <span class="token function-variable function">Rectangle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 初始状态</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>width<span class="token punctuation">,</span> setWidth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>height<span class="token punctuation">,</span> setHeight<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>radius<span class="token punctuation">,</span> setRadius<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token comment">// 行内样式</span>
  <span class="token keyword">const</span> style <span class="token operator">=</span> <span class="token punctuation">{</span>
    width<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    borderRadius<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>radius<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>width<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Slider min<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">50</span><span class="token punctuation">}</span> max<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">300</span><span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token function">setWidth</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Slider<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>height<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Slider min<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">50</span><span class="token punctuation">}</span> max<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">300</span><span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token function">setHeight</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Slider<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>radius<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Slider min<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span> max<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">150</span><span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token function">setRadius</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Slider<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token comment">/* 方形元素 */</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span>style<span class="token punctuation">}</span> className<span class="token operator">=</span><span class="token string">&quot;rectangle&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>样式</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.container .am-slider</span> <span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 10px 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.rectangle</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="useeffect"><a href="#useeffect" class="header-anchor">#</a> useEffect</h1> <h2 id="_1-说明-2"><a href="#_1-说明-2" class="header-anchor">#</a> 1. 说明</h2> <ul><li>Effect Hook 可以让你在函数组件中执行副作用操作
<ul><li>副作用 : 数据获取、设置/销毁定时器以及手动更改 React 组件中的 DOM 都属于副作用</li> <li>在函数组件中，每当DOM完成一次渲染，都会有对应的副作用执行</li></ul></li> <li>官网提示 :</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>如果你熟悉 React <span class="token keyword">class</span> 的生命周期函数，你可以把 useEffect Hook 看做 componentDidMount，componentDidUpdate 和 componentWillUnmount 这三个函数的组合。
</code></pre></div><ul><li>个人建议 :
<ul><li>我们要抛开生命周期的固有思维, 还要注意: 生命周期和useEffect是完全不同的。</li></ul></li> <li>思想</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>在<span class="token keyword">function</span>组件中，每当<span class="token constant">DOM</span><span class="token function">完成一次渲染，都会有对应的副作用执行，useEffect用于提供自定义的执行内容，它的第一个参数（作为函数传入）就是自定义的执行内容。为了避免反复执行，传入第二个参数（由监听值组成的数组）作为比较</span><span class="token punctuation">(</span>浅比较<span class="token punctuation">)</span>变化的依赖，比较之后值都保持不变时，副作用逻辑就不再执行。
</code></pre></div><h2 id="_2-语法-2"><a href="#_2-语法-2" class="header-anchor">#</a> 2. 语法</h2> <h3 id="_2-1-语法格式-2"><a href="#_2-1-语法格式-2" class="header-anchor">#</a> 2.1 语法格式</h3> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">useEffect</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> deps<span class="token punctuation">)</span>
  <span class="token operator">-</span> callback <span class="token operator">:</span> 回调
  <span class="token operator">-</span> deps <span class="token operator">:</span> 依赖数组
</code></pre></div><h3 id="_2-2-语法说明-2"><a href="#_2-2-语法说明-2" class="header-anchor">#</a> 2.2 语法说明</h3> <ul><li><p>回调执行</p> <ul><li>DOM渲染完, 执行一次 useEffect 的回调</li> <li>每次更新之后也会执行 useEffect 的回调</li> <li>每次我们重新渲染，都会生成<em>新的</em> effect，替换掉之前的</li> <li>总结 : 某种意义上讲，effect 更像是渲染结果的一部分 —— 每个 effect “属于”一次特定的渲染</li></ul></li> <li><p>依赖数组</p> <ul><li>可以通过 deps 依赖项 来控制 回调执行的次数</li></ul></li></ul> <h2 id="_3-使用-2"><a href="#_3-使用-2" class="header-anchor">#</a> 3. 使用</h2> <h3 id="_3-1-基本使用"><a href="#_3-1-基本使用" class="header-anchor">#</a> 3.1 基本使用</h3> <ul><li>验证 : 回调执行</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'useEffect'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 更新</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>函数组件<span class="token operator">-</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span> <span class="token operator">-</span> <span class="token punctuation">{</span>num<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token operator">-</span> React 会在每次渲染后都运行 Effect
</code></pre></div><h3 id="_3-1-修改标题案例"><a href="#_3-1-修改标题案例" class="header-anchor">#</a> 3.1 修改标题案例</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 累加</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'useEffect'</span><span class="token punctuation">)</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">您点击了 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 次</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-2-根据依赖项执行-useeffect"><a href="#_3-2-根据依赖项执行-useeffect" class="header-anchor">#</a> 3.2 根据依赖项执行 useEffect</h3> <ul><li>需求 : 只根据count 的变化执行 useEffect</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 初始值</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> setNum<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">// 点击</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>函数组件<span class="token operator">-</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span> <span class="token operator">-</span> <span class="token punctuation">{</span>num<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setNum</span><span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>num<span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token comment">// useEffect</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'useEffect'</span><span class="token punctuation">)</span>
  <span class="token comment">// 假如说 只让count 变化的时候才打印 ,num变化的不打印</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// }, [count, num]) 依赖项 count 和 num</span>

依赖数组就是用来控制是否应该触发 Effect，从而能够减少不必要的计算，从而优化了性能。具体而言，只要依赖数组中的每一项与上一次渲染相比都没有改变，那么就跳过本次 Effect 的执行
</code></pre></div><h3 id="_3-3-定时器"><a href="#_3-3-定时器" class="header-anchor">#</a> 3.3  定时器</h3> <ul><li>依赖项 改为 空数组, 永远只会执行一次</li> <li>空数组,不会有变化内容</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 点击</span>
<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setNum</span><span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>num<span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 原因 : 每次点击 新的 useEffect, 创建一个新的定时器</span>

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   
<span class="token comment">// 需要 添加一个空数组  只执行一次</span>
</code></pre></div><h3 id="_3-3-发送请求"><a href="#_3-3-发送请求" class="header-anchor">#</a> 3.3  发送请求</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 点击</span>
<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setNum</span><span class="token punctuation">(</span>num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>num<span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token comment">// 请求</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  axios
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://api-hmugo-web.itheima.net/api/public/v1/home/swiperdata'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'请求结果'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-5-清除定时器"><a href="#_3-5-清除定时器" class="header-anchor">#</a> 3.5 清除定时器</h3> <ul><li>定时器</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 原因 : 每次点击 新的 useEffect, 创建一个新的定时器</span>
</code></pre></div><ul><li>只创建一次</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 依赖空数组  只创建一个定时器</span>
</code></pre></div><ul><li>打印卸载</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'卸载'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 演示卸载 : </span>
<span class="token keyword">const</span> <span class="token function-variable function">Parent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>isShow<span class="token punctuation">,</span> setShow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setShow</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>父<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>isShow <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Child<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">&gt;</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre></div><ul><li>清除定时器</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// let timer 如果把 timer 放到全局的 这里会有警告 后面再解释</span>

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'卸载'</span><span class="token punctuation">)</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-5-总结"><a href="#_3-5-总结" class="header-anchor">#</a> 3.5 总结</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token operator">==</span><span class="token operator">&gt;</span> 类似 <span class="token operator">:</span> <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token operator">==</span><span class="token operator">&gt;</span> 类似 <span class="token operator">:</span> <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 卸载函数</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token operator">==</span><span class="token operator">&gt;</span> 类似 <span class="token operator">:</span> <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="useref"><a href="#useref" class="header-anchor">#</a> useRef</h1> <h2 id="_1-说明-3"><a href="#_1-说明-3" class="header-anchor">#</a> 1. 说明</h2> <ul><li><code>useRef</code> 返回一个可变的 ref 对象，返回的 ref 对象在组件的整个生命周期内保持不变。</li> <li>用途  :
<ul><li>绑定DOM节点，或者React元素</li> <li>保持可变变量</li></ul></li></ul> <h2 id="_2-语法-3"><a href="#_2-语法-3" class="header-anchor">#</a> 2. 语法</h2> <h3 id="_2-1-语法格式-3"><a href="#_2-1-语法格式-3" class="header-anchor">#</a> 2.1 语法格式</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建ref对象</span>
<span class="token keyword">const</span> myRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-2-语法说明-3"><a href="#_2-2-语法说明-3" class="header-anchor">#</a> 2.2 语法说明</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span> <span class="token comment">// 引入</span>

<span class="token comment">// 创建ref对象</span>
<span class="token keyword">const</span> myRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 获取</span>
myRef<span class="token punctuation">.</span>current
</code></pre></div><h2 id="_3-使用-3"><a href="#_3-使用-3" class="header-anchor">#</a> 3. 使用</h2> <h3 id="_3-1-用途1-保持可变变量"><a href="#_3-1-用途1-保持可变变量" class="header-anchor">#</a> 3.1 用途1- 保持可变变量</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建 ref 对象</span>
<span class="token keyword">const</span> myRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment">// 参数: 初始值</span>

<span class="token comment">// 点击按钮 赋值   </span>
<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ref值'</span><span class="token punctuation">,</span> myRef<span class="token punctuation">.</span>current <span class="token operator">++</span> <span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</code></pre></div><h3 id="_3-2-用途2-绑定dom节点"><a href="#_3-2-用途2-绑定dom节点" class="header-anchor">#</a> 3.2 用途2- 绑定DOM节点</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建 ref 对象</span>
 <span class="token keyword">const</span> iptRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 绑定</span>
<span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token punctuation">{</span>iptRef<span class="token punctuation">}</span> type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">// 获取值</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'iptRef'</span><span class="token punctuation">,</span> iptRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-3-useref-用在定时器上"><a href="#_3-3-useref-用在定时器上" class="header-anchor">#</a> 3.3 useRef 用在定时器上</h3> <ul><li>报警告</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> timer<span class="token punctuation">;</span>  # <span class="token parameter">报警告</span>  <span class="token operator">=&gt;</span> 使用 useRef

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'卸载'</span><span class="token punctuation">)</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>使用 useRef 用在定时器timerId 保存变量</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建 timerRef</span>
<span class="token keyword">const</span> timerRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 存值</span>
  timerRef<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'卸载'</span><span class="token punctuation">)</span>
    <span class="token comment">// 清除</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timerRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_4-demo-动画案例"><a href="#_4-demo-动画案例" class="header-anchor">#</a> 4. Demo - 动画案例</h2> <ul><li><strong>结构和样式</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//结构</span>
<span class="token keyword">const</span> <span class="token function-variable function">Child</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 点击背景</span>
  <span class="token keyword">const</span> <span class="token function-variable function">clickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;ref_container&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>clickHandler<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;ref_el&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 样式</span>
<span class="token punctuation">.</span>ref_container <span class="token punctuation">{</span>
  height<span class="token operator">:</span> <span class="token number">660</span>px<span class="token punctuation">;</span>
  width<span class="token operator">:</span> <span class="token number">375</span>px<span class="token punctuation">;</span>
  background<span class="token operator">:</span> pink<span class="token punctuation">;</span>
  border<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">1</span>px solid pink<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>ref_container <span class="token punctuation">.</span>ref_el <span class="token punctuation">{</span>
  background<span class="token operator">:</span> red<span class="token punctuation">;</span>
  width<span class="token operator">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span>
  margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>通过 ref 获取元素</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 创建 ref</span>
 
 <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;ref_el&quot;</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>element<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>     <span class="token comment">// 绑定ref元素</span>
</code></pre></div><ul><li>创建第一个动画 :</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> anime <span class="token keyword">from</span> <span class="token string">'animejs'</span><span class="token punctuation">;</span>

<span class="token comment">// 第一个动画</span>
<span class="token keyword">function</span> <span class="token function">ml_animate01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">anime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      targets<span class="token operator">:</span> element<span class="token punctuation">.</span>current<span class="token punctuation">,</span>
      translateX<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
      backgroundColor<span class="token operator">:</span> <span class="token string">'#ff8822'</span><span class="token punctuation">,</span>
      borderRadius<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'0%'</span><span class="token punctuation">,</span> <span class="token string">'50%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 点击背景</span>
<span class="token keyword">const</span> <span class="token function-variable function">clickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">ml_animate01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>创建第二个动画</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第一个动画 : 移动到右侧</span>
<span class="token keyword">function</span> <span class="token function">ml_animate01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token comment">// 第一个动画完了 执行第二个动画</span>
     <span class="token function">ml_animate02</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 第二个动画 : 返回原点</span>
<span class="token keyword">function</span> <span class="token function">ml_animate02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">anime</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      targets<span class="token operator">:</span> element<span class="token punctuation">.</span>current<span class="token punctuation">,</span>
      translateX<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      backgroundColor<span class="token operator">:</span> <span class="token string">'#f00'</span><span class="token punctuation">,</span>
      borderRadius<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'50%'</span><span class="token punctuation">,</span> <span class="token string">'0%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>配合 useStat 和 useEffect 切换动画</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 是否开始动画    true-开始动画  false-结束动画</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>isAnimate1<span class="token punctuation">,</span> setAnimate1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>isAnimate2<span class="token punctuation">,</span> setAnimate2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  isAnimate1 <span class="token operator">&amp;&amp;</span> <span class="token function">ml_animate01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>isAnimate1<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  isAnimate2 <span class="token operator">&amp;&amp;</span> <span class="token function">ml_animate02</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>isAnimate2<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 动画1</span>
<span class="token keyword">function</span> <span class="token function">ml_animate01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setAnimate1</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 第一个动画结束</span>
    <span class="token function">setAnimate2</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>  <span class="token comment">// 第二个动画开始</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 动画2</span>
<span class="token keyword">function</span> <span class="token function">ml_animate02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>  
  <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setAnimate2</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 第二个动画结束</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 点击背景</span>
<span class="token keyword">const</span> <span class="token function-variable function">clickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setAnimate1</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 第一个动画开始</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="usereducer"><a href="#usereducer" class="header-anchor">#</a> useReducer</h1> <h2 id="_1-说明-4"><a href="#_1-说明-4" class="header-anchor">#</a> 1. 说明</h2> <ul><li>useState  的替代方案。</li> <li>它接收一个( 形如 <code>(oldState, action) =&gt; newState</code> 的)  reducer，并返回当前的 state 以及与其配套的 <code>dispatch</code> 方法。</li></ul> <h2 id="_2-语法-4"><a href="#_2-语法-4" class="header-anchor">#</a> 2. 语法</h2> <p>###2.1 语法格式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initial<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-2-语法说明-4"><a href="#_2-2-语法说明-4" class="header-anchor">#</a> 2.2 语法说明</h3> <ul><li>参数 :   1-reducer  2-状态初始值</li> <li>返回值 :  当前的 state 以及与其配套的 <code>dispatch</code> 方法。</li></ul> <h2 id="_3-使用-4"><a href="#_3-使用-4" class="header-anchor">#</a> 3. 使用</h2> <h3 id="_3-1-重写-usestate-计算器示例"><a href="#_3-1-重写-usestate-计算器示例" class="header-anchor">#</a> 3.1 重写 useState (计算器示例)</h3> <ul><li>之前的 useState</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>counter<span class="token punctuation">,</span> setCounter<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>函数组件 <span class="token operator">-</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCounter</span><span class="token punctuation">(</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCounter</span><span class="token punctuation">(</span>counter <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>改造的 useReducer</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token comment">// reducer</span>
<span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'increment'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">case</span> <span class="token string">'decrement'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>counter<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>函数组件 <span class="token operator">-</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'increment'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'decrement'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-2-usereducer-使用场景"><a href="#_3-2-usereducer-使用场景" class="header-anchor">#</a> 3.2 useReducer 使用场景</h3> <ul><li>在某些场景下，<code>useReducer</code> 会比 <code>useState</code> 更适用 : 例如 state 逻辑较复杂且包含多个子值，或者下一个 state 依赖于之前的 state 等</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span>count<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'increment'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>count<span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'decrement'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>count<span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      Count<span class="token operator">:</span> <span class="token punctuation">{</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'decrement'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'increment'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="usecontext"><a href="#usecontext" class="header-anchor">#</a> useContext</h1> <h2 id="_1-说明-5"><a href="#_1-说明-5" class="header-anchor">#</a> 1. 说明</h2> <ul><li><code>useContext</code>，能够让我们在函数组件中使用context的能力, 替换之前的 <code>context.Consumer</code></li></ul> <h2 id="_2-语法-5"><a href="#_2-语法-5" class="header-anchor">#</a> 2. 语法</h2> <h3 id="_2-1-语法格式-4"><a href="#_2-1-语法格式-4" class="header-anchor">#</a> 2.1 语法格式</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>MyContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-2-语法说明-5"><a href="#_2-2-语法说明-5" class="header-anchor">#</a> 2.2 语法说明</h3> <ul><li>参数 :  一个 context对象</li> <li>返回值 :  返回 Provider 提供的 value 值</li></ul> <h3 id="_2-3-使用说明"><a href="#_2-3-使用说明" class="header-anchor">#</a> 2.3 使用说明</h3> <ul><li>回忆 :
<ul><li>之前在类组件件中 , 使用 context实现从上到下跨多层组件传递数据</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.</span> 通过 <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 创建 context对象
   <span class="token keyword">const</span> myContext <span class="token operator">=</span>  React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
   
<span class="token number">2.</span> 在context对象中，提供了一个自带的 Provider 组件<span class="token punctuation">,</span> 用来提供数据。
   <span class="token operator">&lt;</span>myContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span> 数据 <span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">...</span><span class="token punctuation">.</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>myContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>

<span class="token number">3.</span> 在context对象中，提供了一个自带的 Consumer 组件<span class="token punctuation">,</span> 用来接收数据。
    <span class="token operator">&lt;</span>myContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>  <span class="token parameter">data</span> <span class="token operator">=&gt;</span> data 就是传递过来的数据 <span class="token punctuation">}</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>myContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
</code></pre></div><ul><li><strong>在函数组件中, 使用 useContext hook 可以实现三个功能</strong> <ul><li>功能1 : 实现从上到下跨多层组件传递数据</li> <li>功能2 : 兄弟组件数据交互   (共享数据)</li> <li>功能3 : 配合 useReducer 组合 redux</li></ul></li></ul> <h2 id="_3-使用-5"><a href="#_3-使用-5" class="header-anchor">#</a> 3. 使用</h2> <p>###3.1 功能1-跨多层组件传递数据</p> <ul><li>Context : context.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// context.js </span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>父组件 : index.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入 context</span>
<span class="token keyword">import</span> myContext <span class="token keyword">from</span> <span class="token string">'./demo1/context'</span>

<span class="token comment">// 提供数据</span>
<span class="token operator">&lt;</span>myContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'哈哈哈'</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
   <span class="token operator">...</span>
   <span class="token operator">&lt;</span>Child<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>myContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
</code></pre></div><ul><li>子组件 : child.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入 context</span>
<span class="token keyword">import</span> myContext <span class="token keyword">from</span> <span class="token string">'./context'</span>

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">Child</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取 context 里面的数据</span>
  <span class="token keyword">const</span> val <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>myContext<span class="token punctuation">)</span>
  
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>子组件 <span class="token operator">-</span> <span class="token punctuation">{</span> val <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-2-功能2-封装-provider-共享数据"><a href="#_3-2-功能2-封装-provider-共享数据" class="header-anchor">#</a> 3.2 功能2-封装  Provider-共享数据</h3> <ul><li>Context : context.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token comment">// 导出1 : context</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> myContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                      # 导出   myContext

<span class="token comment">// 导出2 : 函数组件</span>
<span class="token comment">// 重定义 Provider</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">MyProvider</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                          # 导出   函数组件
  <span class="token comment">// 初始值</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token comment">// 组合要传递的共享数据   </span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">,</span>
    <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">decrement</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>myContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>myContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>Counter1 组件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入包</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token comment">// 引入 context</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> myContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>                             # 引入 myContext

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">Counter1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> counter<span class="token punctuation">,</span> increment<span class="token punctuation">,</span> decrement <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>myContext<span class="token punctuation">)</span> # 获取共享数据

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>函数组件<span class="token number">1</span> <span class="token operator">-</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>函数组件 <span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>函数组件 <span class="token operator">-</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//3. 渲染DOM</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Counter1
</code></pre></div><ul><li>Counter2 组件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入包</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> myContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>                              # 引入 myContext

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">Counter2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  
  <span class="token keyword">const</span> <span class="token punctuation">{</span> counter<span class="token punctuation">,</span> increment<span class="token punctuation">,</span> decrement <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>myContext<span class="token punctuation">)</span>   # 获取共享数据

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>函数组件<span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">{</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>函数组件 <span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>函数组件 <span class="token operator">-</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//3. 渲染DOM</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Counter2
</code></pre></div><ul><li>父组件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入包</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Counter1 <span class="token keyword">from</span> <span class="token string">'./demo2/Counter1'</span>
<span class="token keyword">import</span> Counter2 <span class="token keyword">from</span> <span class="token string">'./demo2/Counter2'</span>

<span class="token comment">// 引入  Provider</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MyProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>                            # 引入 MyProvider

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                                                               #   包裹着要共享数据的组件 
      <span class="token operator">&lt;</span>MyProvider<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Child1<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Child1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Child2<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Child2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>MyProvider<span class="token operator">&gt;</span>
    
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//3. 导出组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App
</code></pre></div><h3 id="_3-3-功能3-usecontext-和-usereducer-组合-redux"><a href="#_3-3-功能3-usecontext-和-usereducer-组合-redux" class="header-anchor">#</a> 3.3 功能3- useContext 和 useReducer 组合 redux</h3> <ul><li><strong>文件1 : context.js</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token comment">// 导出 context</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> myContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 第一个 reducer</span>
<span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'increment'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">case</span> <span class="token string">'decrement'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// 导出 Provider</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">MyProvider</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">,</span>
    dispatch
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>myContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>values<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>myContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li><strong>文件2 : 父组件  index.js</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入包</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Counter1 <span class="token keyword">from</span> <span class="token string">'./Counter1'</span>
<span class="token keyword">import</span> Counter2 <span class="token keyword">from</span> <span class="token string">'./Counter2'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MyProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>函数组件<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>MyProvider<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Counter1<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Counter1<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Counter2<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Counter2<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>MyProvider<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//3. 导出组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App
</code></pre></div><ul><li><strong>文件3 : 子组件  countert1.js</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入包</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> myContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">Counter1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>myContext<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Counter1 <span class="token operator">-</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'increment'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//3. 导出组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Counter1
</code></pre></div><ul><li><strong>文件4 :子组件  counter2.js</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入包</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> myContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">Counter2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> dispatch <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>myContext<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Counter2 <span class="token operator">-</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'decrement'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
 
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//3. 导出组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Counter2
</code></pre></div><p>###3.4  组合 redux 重写黑马课程todos案例 (简易版)</p> <h1 id="usememo"><a href="#usememo" class="header-anchor">#</a> useMemo</h1> <h2 id="_1-说明-6"><a href="#_1-说明-6" class="header-anchor">#</a> 1. 说明</h2> <ul><li>useMemo 可以让你在函数组件中 缓存计算结果</li></ul> <h2 id="_2-语法-6"><a href="#_2-语法-6" class="header-anchor">#</a> 2. 语法</h2> <p>###2.1 语法格式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> memoizedValue <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> deps<span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-2-语法说明-6"><a href="#_2-2-语法说明-6" class="header-anchor">#</a> 2.2 语法说明</h3> <ul><li>它接收两个参数，
<ul><li>第一个参数为回调函数  (计算过程fn，必须返回一个结果)，</li> <li>第二个参数是依赖项(数组)，当依赖项中某一个发生变化，结果将会重新计算。</li></ul></li> <li>注意 : 因为是缓存计算结果,所以参数1回调函数里面一定要有return返回值</li></ul> <h2 id="_2-使用"><a href="#_2-使用" class="header-anchor">#</a> 2. 使用</h2> <ul><li>使用 useMemo 之前
<ul><li>问题 : 每次点击干扰项 other, 都要重新计算一下,所以需要缓存值</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>other<span class="token punctuation">,</span> setOther<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token comment">// 累加的方法</span>
  <span class="token keyword">function</span> <span class="token function">calcCount</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'重新计算了一次'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> _sum <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _sum <span class="token operator">+=</span> i
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _sum
  <span class="token punctuation">}</span>
  <span class="token comment">// 结算的结果</span>
  <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token function">calcCount</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        参数 <span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span> 累加 <span class="token operator">:</span> <span class="token punctuation">{</span>sum<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>修改参数<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setOther</span><span class="token punctuation">(</span>other <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>干扰项 <span class="token punctuation">{</span>other<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>使用 useMemo</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 累加的方法 </span>
  <span class="token keyword">function</span> <span class="token function">calcCount</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'重新计算了一次'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> _sum <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _sum <span class="token operator">+=</span> i
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _sum               #  记忆的是 _sum
  <span class="token punctuation">}</span>
  <span class="token comment">// 结算的结果 </span>
  <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">calcCount</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>      #   使用 useMemo 

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        参数 <span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span> 累加 <span class="token operator">:</span> <span class="token punctuation">{</span>sum<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>修改参数<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setOther</span><span class="token punctuation">(</span>other <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>干扰项 <span class="token punctuation">{</span>other<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
</code></pre></div><h1 id="usecallback"><a href="#usecallback" class="header-anchor">#</a> useCallback</h1> <h2 id="_1-说明-7"><a href="#_1-说明-7" class="header-anchor">#</a> 1. 说明</h2> <ul><li>useCallback 可以让你在函数组件中 缓存计算函数</li></ul> <h2 id="_2-语法-7"><a href="#_2-语法-7" class="header-anchor">#</a> 2. 语法</h2> <p>###2.1 语法格式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fnA <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>fnB<span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-2-语法说明-7"><a href="#_2-2-语法说明-7" class="header-anchor">#</a> 2.2 语法说明</h3> <ul><li>useCallback 会将我们传递给它的函数fnB返回，并且将这个结果fnA 缓存；</li> <li>当依赖a变更时，会返回新的函数。</li></ul> <blockquote><p>把内联回调函数及依赖项数组作为参数传入 <code>useCallback</code>，它将返回该回调函数的 memoized 版本，该回调函数仅在某个依赖项改变时才会更新。当你把回调函数传递给经过优化的并使用引用相等性去避免非必要渲染（例如 <code>shouldComponentUpdate</code>）的子组件时，它将非常有用。</p></blockquote> <h2 id="_3-使用-6"><a href="#_3-使用-6" class="header-anchor">#</a> 3. 使用</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// const inputChange = e =&gt; {</span>
<span class="token comment">//   console.log(e.target.value)</span>
<span class="token comment">// }</span>

<span class="token comment">// 这里面的箭头函数 依赖 count</span>
<span class="token comment">// 如果 count 有变化, 就会创建一个新的 ()=&gt;{}</span>
<span class="token comment">// 如果 count 没有变化,</span>
<span class="token keyword">const</span> inputChange <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>函数组件 <span class="token operator">-</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>inputChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>改count<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setOther</span><span class="token punctuation">(</span>other <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>改干扰项<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="_4-验证"><a href="#_4-验证" class="header-anchor">#</a> 4. 验证</h2> <ul><li>返回的是函数，我们无法很好的判断返回的函数是否变更，所以我们可以借助ES6新增的数据类型Set来判断，</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建一个  全局的  set</span>
<span class="token keyword">const</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 缓存函数   </span>
<span class="token keyword">const</span> inputChange <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'input获取的值'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 如果 地址一样 是不会添加的 地址不一样才会添加</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>inputChange<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'长度'</span><span class="token punctuation">,</span> set<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
</code></pre></div><h2 id="_5-使用场景"><a href="#_5-使用场景" class="header-anchor">#</a> 5. 使用场景</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token comment">// 干扰</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>other<span class="token punctuation">,</span> setOther<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> inputChange <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span>

  set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>inputChange<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'set个数'</span><span class="token punctuation">,</span> set<span class="token punctuation">.</span>size<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        函数组件 <span class="token operator">-</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span> <span class="token operator">-</span> <span class="token punctuation">{</span>other<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>inputChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>改<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setOther</span><span class="token punctuation">(</span>other <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>改<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Child f<span class="token operator">=</span><span class="token punctuation">{</span>inputChange<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// memo 是缓存外界传来的函数 不变会不更新</span>
<span class="token comment">// 自己如果不变的话 自己就不更新了</span>
<span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> f <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child'</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Child组件<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="自定义-hook"><a href="#自定义-hook" class="header-anchor">#</a> 自定义 Hook</h1> <h2 id="_1-自定义hook1-usemouse"><a href="#_1-自定义hook1-usemouse" class="header-anchor">#</a> 1. 自定义Hook1 - useMouse</h2> <ul><li>封装 useMouse</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入包</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">useMouse</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>mouse<span class="token punctuation">,</span> setMouse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleMouse</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setMouse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      x<span class="token operator">:</span> e<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
      y<span class="token operator">:</span> e<span class="token punctuation">.</span>clientY
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> handleMouse<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> handleMouse<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> mouse
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useMouse
</code></pre></div><ul><li>使用 useMouse</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 引入</span>
<span class="token keyword">import</span> useMouse <span class="token keyword">from</span> <span class="token string">'./useMouse'</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2. 获取 坐标值</span>
  <span class="token keyword">const</span> mouse <span class="token operator">=</span> <span class="token function">useMouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token comment">// 3. 使用坐标</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> 函数组件 <span class="token punctuation">{</span>mouse<span class="token punctuation">.</span>x<span class="token punctuation">}</span> <span class="token operator">-</span> <span class="token punctuation">{</span>mouse<span class="token punctuation">.</span>y<span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-自定义-hook2-userequest"><a href="#_2-自定义-hook2-userequest" class="header-anchor">#</a> 2. 自定义 Hook2 - useRequest</h2> <ul><li>封装的自定义hook</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

<span class="token keyword">const</span> <span class="token function-variable function">useRequest</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isLoading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>response<span class="token punctuation">,</span> setResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token comment">// 钩子</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isLoading<span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>isLoading<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token comment">// 获取数据</span>
  <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    axios
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>
        <span class="token string">'https://api-hmugo-web.itheima.net/api/public/v1/goods/qsearch?query=1'</span>
      <span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'useeffect'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token function">setResponse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> isLoading<span class="token punctuation">,</span> setLoading<span class="token punctuation">,</span> response <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useRequest

</code></pre></div><ul><li>使用hook</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> useRequest <span class="token keyword">from</span> <span class="token string">'./useRequest'</span>

<span class="token comment">//2. 创建组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// isLoading</span>
  <span class="token comment">//  true : 正在加载</span>
  <span class="token comment">//  false  : 加载完成</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> isLoading<span class="token punctuation">,</span> setLoading<span class="token punctuation">,</span> response <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点击再次刷新<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>isLoading <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>正在努力加载中<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span>response<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>goods_id<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>goods_name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h1> <h2 id="_1-准备工作"><a href="#_1-准备工作" class="header-anchor">#</a> 1. 准备工作</h2> <ul><li>antd-mobile  ( Badge徽标数)  https://mobile.ant.design/components/badge-cn/</li> <li>接口1  https://api-hmugo-web.itheima.net/api/public/v1/goods/qsearch?query=1</li> <li>接口2 https://api-hmugo-web.itheima.net/api/public/v1/home/catitems</li> <li>自定义hook</li></ul> <h2 id="_2-使用步骤"><a href="#_2-使用步骤" class="header-anchor">#</a> 2. 使用步骤</h2> <h3 id="_2-1-界面搭建"><a href="#_2-1-界面搭建" class="header-anchor">#</a> 2.1 界面搭建</h3> <ul><li>创建 App =&gt; Home - Hot - Setting</li> <li>tab的结构 和 样式</li> <li>点击 tab 切换 结构和高亮样式</li> <li>Badge 加上徽标和样式</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 结构</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>tabIndex<span class="token punctuation">,</span> setTabIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token comment">/* tab 部分 */</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;tab&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div
          className<span class="token operator">=</span><span class="token punctuation">{</span>tabIndex <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">'active'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span>
          onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTabIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Badge text<span class="token operator">=</span><span class="token string">&quot;10&quot;</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginLeft<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            首页
          <span class="token operator">&lt;</span><span class="token operator">/</span>Badge<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div
          className<span class="token operator">=</span><span class="token punctuation">{</span>tabIndex <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">'active'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span>
          onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTabIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Badge text<span class="token operator">=</span><span class="token string">&quot;5&quot;</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginLeft<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            热门
          <span class="token operator">&lt;</span><span class="token operator">/</span>Badge<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div
          className<span class="token operator">=</span><span class="token punctuation">{</span>tabIndex <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token string">'active'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span>
          onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setTabIndex</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          设置
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token comment">/* 列表部分 */</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>tabIndex <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Home<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Home<span class="token operator">&gt;</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span>tabIndex <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Hot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Hot<span class="token operator">&gt;</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span>tabIndex <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Setting<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Setting<span class="token operator">&gt;</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 样式</span>
<span class="token punctuation">.</span>tab <span class="token punctuation">{</span>
  height<span class="token operator">:</span> <span class="token number">40</span>px<span class="token punctuation">;</span>
  background<span class="token operator">:</span> yellow<span class="token punctuation">;</span>
  display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>tab <span class="token operator">&gt;</span> div <span class="token punctuation">{</span>
  flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
  justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
  align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
  border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">2</span>px solid pink<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>tab <span class="token operator">&gt;</span> div<span class="token punctuation">.</span>active <span class="token punctuation">{</span>
  border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">2</span>px solid red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>am<span class="token operator">-</span>activity<span class="token operator">-</span>indicator <span class="token punctuation">{</span>
  justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">*</span> <span class="token punctuation">{</span>
  touch<span class="token operator">-</span>action<span class="token operator">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>am<span class="token operator">-</span>list<span class="token operator">-</span>item <span class="token punctuation">.</span>am<span class="token operator">-</span>list<span class="token operator">-</span>line <span class="token punctuation">.</span>am<span class="token operator">-</span>list<span class="token operator">-</span>extra <span class="token punctuation">{</span>
  overflow<span class="token operator">:</span> visible<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-2-发送请求-home-hot"><a href="#_2-2-发送请求-home-hot" class="header-anchor">#</a> 2.2 发送请求-Home-Hot</h3> <ul><li><strong>封装自定义hook 请求</strong> - request.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState<span class="token punctuation">,</span> useCallback <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token comment">// 首页请求</span>
<span class="token keyword">const</span> <span class="token function-variable function">useRequestHome</span> <span class="token operator">=</span> <span class="token parameter">url</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isLoading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>response<span class="token punctuation">,</span> setResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> getData <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setResponse</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isLoading<span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>getData<span class="token punctuation">,</span> isLoading<span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> isLoading<span class="token punctuation">,</span> response <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useRequestHome
</code></pre></div><ul><li><strong>home.js  使用 自定义 hook</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入核心包</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span>  useRequestHome  <span class="token keyword">from</span> <span class="token string">'./request'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ActivityIndicator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd-mobile'</span>

<span class="token comment">//2. 类组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span>
    <span class="token string">'https://api-hmugo-web.itheima.net/api/public/v1/goods/qsearch?query=1'</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> isLoading<span class="token punctuation">,</span> response <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequestHome</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isLoading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>ActivityIndicator<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ActivityIndicator<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>response<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>goods_id<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>goods_name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//3. 导出组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Home
</code></pre></div><ul><li><strong>hot.js 使用 自定义 hook</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入核心包</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span>  useRequestHome  <span class="token keyword">from</span> <span class="token string">'./request'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ActivityIndicator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd-mobile'</span>

<span class="token comment">//2. 类组件</span>
<span class="token keyword">const</span> <span class="token function-variable function">Hot</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">'https://api-hmugo-web.itheima.net/api/public/v1/home/catitems'</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> isLoading<span class="token punctuation">,</span> response <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRequestHome</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>isLoading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>ActivityIndicator<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ActivityIndicator<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>response<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>goods_id<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//3. 导出组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Hot
</code></pre></div><h3 id="_2-3-封装-provider"><a href="#_2-3-封装-provider" class="header-anchor">#</a> 2.3 封装 Provider</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token comment">// 导出两个 context</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> myContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 导出 Provider</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Provider</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>unReadHome<span class="token punctuation">,</span> setUnReadHome<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>unReadHot<span class="token punctuation">,</span> setUnReadHot<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">{</span>
    unReadHome<span class="token punctuation">,</span>
    setUnReadHome<span class="token punctuation">,</span>
    unReadHot<span class="token punctuation">,</span>
    setUnReadHot
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>myContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>values<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>myContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>提供数据 - index.js (父组件)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>Provider<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>App<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>App<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-4-读取-徽标"><a href="#_2-4-读取-徽标" class="header-anchor">#</a> 2.4 读取 徽标</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Provider<span class="token punctuation">,</span> myContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> unReadHome<span class="token punctuation">,</span> unReadHot <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>myContext<span class="token punctuation">)</span>

<span class="token operator">&lt;</span>Badge text<span class="token operator">=</span><span class="token punctuation">{</span>unReadHome<span class="token punctuation">}</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginLeft<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
  首页
<span class="token operator">&lt;</span><span class="token operator">/</span>Badge<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>Badge text<span class="token operator">=</span><span class="token punctuation">{</span>unReadHot<span class="token punctuation">}</span> style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> marginLeft<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
热门
  <span class="token operator">&lt;</span><span class="token operator">/</span>Badge<span class="token operator">&gt;</span>

</code></pre></div><h3 id="_2-5-设置页面-setting"><a href="#_2-5-设置页面-setting" class="header-anchor">#</a> 2.5 设置页面 - Setting</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 引入核心包</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> myContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../context'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> List<span class="token punctuation">,</span> Stepper <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd-mobile'</span>

<span class="token comment">//2. 类组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Setting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>unReadHome<span class="token punctuation">,</span> setUnReadHome<span class="token punctuation">,</span> unReadHot<span class="token punctuation">,</span> setUnReadHot<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>myContext<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>List<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>List<span class="token punctuation">.</span>Item
          wrap
          extra<span class="token operator">=</span><span class="token punctuation">{</span>
            <span class="token operator">&lt;</span>Stepper
              showNumber
              min<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>
              value<span class="token operator">=</span><span class="token punctuation">{</span>unReadHome<span class="token punctuation">}</span>
              onChange<span class="token operator">=</span><span class="token punctuation">{</span>setUnReadHome<span class="token punctuation">}</span>
            <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          首页未读
        <span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>List<span class="token punctuation">.</span>Item
          extra<span class="token operator">=</span><span class="token punctuation">{</span>
            <span class="token operator">&lt;</span>Stepper
              showNumber
              min<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span>
              value<span class="token operator">=</span><span class="token punctuation">{</span>unReadHot<span class="token punctuation">}</span>
              onChange<span class="token operator">=</span><span class="token punctuation">{</span>setUnReadHot<span class="token punctuation">}</span>
            <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token punctuation">}</span>
        <span class="token operator">&gt;</span>
          热门未读
        <span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/pages/notes/React学习笔记.html" class="prev">
        React学习笔记
      </a></span> <span class="next"><a href="/pages/notes/git笔记.html">
        git笔记
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1b02cb7d.js" defer></script><script src="/assets/js/2.9788d3fd.js" defer></script><script src="/assets/js/16.89b6987f.js" defer></script>
  </body>
</html>
